---
layout: post
title: "sed入门"
date: 2014-07-14 21:26:23 +0800
comments: true
categories: Language
Tags: sed

---

####Sed入门

sed - stream editor for filtering and transforming text

sed是非交互式编辑器，很强大．掌握了将得心应手．命令很简单，关键是熟练运用．入门也很简单．估计一个小时内就了解了

<!--more-->

#####特点

- 1.sed不会修改文件
- 2.默认所有的输出行都被打印到屏幕上.具体是读入一行到缓冲区，处理这一行，发送到屏幕，删除缓冲区内容，处理下一行
- 3. sed [选项]... {脚本(如果没有其他脚本)} [输入文件]...
- 4. sed不管是否找到指定的模式，它的退出状态都是0。只有当命令存在语法错误时，sed的退出状态才不是0

#####命令和选项
命令　    | 解释
--------- |--------------------
a\        |在当前行后添加一行或多行。多行时除最后一行外，每行末尾需用“\”续行
 c\	| 用此符号后的新文本替换当前行中的文本。多行时除最后一行外，每行末尾需用"\"续行
 i\	| 在当前行之前插入文本。多行时除最后一行外，每行末尾需用"\"续行
 d	| 删除行
 h	| 把模式空间里的内容复制到暂存缓冲区
 H	| 把模式空间里的内容追加到暂存缓冲区
 g	| 把暂存缓冲区里的内容复制到模式空间，覆盖原有的内容
 G	| 把暂存缓冲区的内容追加到模式空间里，追加在原有内容的后面
 l	| 列出非打印字符
 p	| 打印行
 n	| 读入下一输入行，并从下一条命令而不是第一条命令开始对其的处理
 q	| 结束或退出sed
 r	| 从文件中读取输入行
 !	| 对所选行以外的所有行应用命令
 s	| 用一个字符串替换另一个
 g	| 在行内进行全局替换
 w	| 将所选的行写入文件
 x	| 交换暂存缓冲区与模式空间的内容
 y	| 将字符替换为另一字符（不能对正则表达式使用y命令）
 -e |    进行多项编辑，即对输入行应用多条sed命令时使用
 -n |   取消默认的输出
 -f |  指定sed脚本的文件名

#####正则表达式

**正则表达式要括在斜杠线"/"之间.如果要把正则表达式分隔符"/"改为另一个字符，比如o，则"\o..o",例如：sed -n '\o^Myop' datafile

元字符   | 功能            |   示例
---------|-----------------|---------
^ | 行首定位符 | /^my/  匹配所有以my开头的行
$  |   行尾定位符 | /my$/  匹配所有以my结尾的行
.  |  匹配除换行符以外的单个字符 | /m..y/  匹配包含字母m，后跟两个任意字符，再跟字母y的行
*  | 匹配零个或多个前导字符 | /my*/  匹配包含字母m,后跟零个或多个y字母的行
[] |匹配指定字符组内的任一字符 | /[Mm]y/  匹配包含My或my的行
[^]|匹配不在指定字符组内的任一字符|/[^Mm]y/  匹配包含y，但y之前的那个字符不是M或m的行
 \(..\)|   保存已匹配的字符 |   1,20s/\(you\)self/\1r/  标记元字符之间的模式，并将其保存为标签1，之后可以使用\1来引用它。最多可以定义9个标签，从左边开始编号，最左边的是第一个。此例中，对第1到第20行进行处理，you被保存为标签1，如果发现youself，则替换为your。
& |保存查找串以便在替换串中引用|s/my/**&**/  符号&代表查找串。my将被替换为**my**
\<|词首定位符 | /\<my/  匹配包含以my开头的单词的行
\>|词尾定位符|/my\>/|  匹配包含以my结尾的单词的行
x\{m\}|连续m个x|/9\{5\}/ 匹配包含连续5个9的行
x\{m,\}|至少m个x|/9\{5,\}/  匹配包含至少连续5个9的行
x\{m,n\}|至少m个，但不超过n个x|/9\{5,7\}/  匹配包含连续5到7个9的行

#####示例
    sed '2,5d' file删除2到5行
    sed '/My/,/You/d' file 删除包含My的和到包含You之间的行
    sed '$d' file删除最后一行，其余的打印
    sed '/my/p' file把所有行打印一次，再把包含my的行打印一次
    sed -n '/my/p' file -n取消了默认打印，只打印匹配项
    sed 's/^my/you/g' file 替换my为you,g表示所有的都替换
    sed -n '2,20s/my$/you/gp' file 替换，并只打印替换的行，上一个会默认全打印
    sed -e '1,100d' -e 's/a/b/g' file多重编辑

